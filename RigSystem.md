# Описание системы ригов

## Общее описание

  **Риг, в контексте нашей программы, это "скелет" объекта, набор связанных одним родительским контейнером якорных точек.**
  
  **Якорная точка, в контексте нашей программы, это родительский контейнер для изображения.**
  
  **Анимация изображений осуществляется путём анимации положения и вращения якорной точки, в которой находится это изображение.**
  
  **Риг может принадлежать персонажу, в этом случае в его, конкретные, якорные точки, можно помещать риг принадлежащий "вещи".**
  
## Преимущества системы

  - Легкое создание персонажей (игроков, монстров, боссов и т.д.);

  - Легкое создание вещей окружающего мира (сундуки, лут, двери и т.д.);

  - Легкое создание вещей персонажей (оружие, доспехи, костюмы и т.д.);

  - Легкое создание снарядов (заклинания, стрелы, бомбы и т.д.);

  - Легкое анимирование всех созданных ригов;

  - Легкий вызов конкретных анимаций из кода.
  
## Базовые классы

  *Количество классов сознательно уменьшено в ущерб декомпозиции, для того, чтобы было удобно хранить Rig в JSON формате*

### Rig
  
  **Шаблоны внутренних объектов:**
  
  - **anchorPoint**: объект якороной точки;
   
      - **name**: уникальное (внутри рига) наименование;

      - **element**: HTML элемент;

      - **left**: смещение от левого края;

      - **bottom**: смещение от нижнего края;

      - **rotate**: градусы вращения;

      - **duration**: длительность анимации;

      - **skinElement**: HTML элемент дочернего изображения;

      - **skinSrc**: путь к дочернему изображению;

      - **skinLeft**: смещение дочернего изображения от левого края;

      - **skinBottom**: смещение дочернего изображения от нижнего края;

      - **skinRotate**: градусы вращения дочернего изображения;

      - **animations**: список **animation**.


  - **animation**: объект анимации;

    - **name**: уникальное (внутри якорной точки) наименование анимации;

    - **inProgress**: флаг состояния анимации;

    - **isCycle**: флаг цикличности анимации;

    - **keyPoints**: список **keyPoint**.


  - **keyPoint**: объект ключевой точки.

    - **duration**: продолжительность анимации в этой ключевой точке;

    - **timeout**: тайм-аут до запуска следующей ключевой точки;

    - **left**: смещение от левого края в этой ключевой точке;

    - **bottom**: смещение от нижнего края в этой ключевой точке;

    - **rotation**: градусы вращения в этой ключевой точке.

  
  **Поля:**

  - **id**: уникальный идентификатор;

  - **name**: уникальное наименование;

  - **element**: HTML элемент;

  - **height**: высота;

  - **width**: ширина;
  
  - **anchorPoints**: список **anchorPoint**. 
    
  **Методы:**

  - **createElement**: создание HTML элемента;

  - **save**: сохранение в базу данных;

  - **load**: загрузка из базы данных;

  - **remove**: удаление из базы данных;

  - **rename**: смена наименования;

  - **getName**: возврат наименования;

  - **getId**: возврат id;

  - **changeSize**: изменение высоты и/или ширины;

  - **addAnchorPoint**: добавить якорную точку;
 
  - **removeAnchorPoint**: удалить якорную точку;

  - **moveAnchorPoint**: изменить положение якорной точки;

  - **changeAnchorPointSkin**: изменить дочернее изображение якорной точки;
  
  - **moveAnchorPointSkin**: изменить положение дочернего изображения якорной точки;

  - **addAnimation**: добавить анимацию якорной точки;

  - **removeAnimation**: удалить анимацию якорной точки;

  - **renameAnimation**: переименовать анимацию якорной точки;

  - **playAnimation**: запустить анимацию якорной точки;

  - **goToNextKeyPoint**: применить изменения ключевой точки;

  - **stopAnimation**: остановить анимацию якорной точки;

  - **addKeyFrame**: добавить ключевую точку анимации якорной точки;

  - **removeKeyFrame**: удалить ключевую точку анимации якорной точки;

  - **updateKeyFrame**: изменить содержание ключевой точки анимации якорной точки.

## Наследники базовых классов

### ActorRig *extends* Rig

  **Шаблоны внутренних объектов:**
  
  - **item**: вещь, привязанная к якорной точке.

    - **id**: уникальный идентификатор рига вещи;

    - **anchorPointName**: наименования якорной точки, к которой привязана вещь.

  **Расширение внутренних объектов:**

  - **anchorPoint**:
  
    - **itemRig**: Rig вещи, привязанной к якорной точке.

  **Поля**
  
  - **items**: список **item**

  **Методы**
  
  - **changeItem**: смена вещи, привязанной к якорной точке;

  - **playItemAnimation**: старт анимации вещи, привязанной к якорной точке;

  - **stopItemAnimation**: остановка анимации вещи, привязанной к якорной точке.
